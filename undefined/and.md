# 서버 간 통신 & 스프링 부트의 동작방식



## ✅ 서버간 통신



서버 간 통신은 한 서버가 다른 서버에 통신을 요청하는 것을 의미한다.

많은 통신방식이 존재하지만 웹상에서는 주로 사용하는 통신 방식이 `HTTP/HTTPS` 방식입니다.



## ✅ 스프링 부트의 동작 방식

`spring-boot-starter-web` 모듈을 사용하면 기본적으로 톰캣을 사용하는 스프링 MVC 구조를 기반으로 동작한다.



### 📌 서블릿 과 서블릿 컨테이너

서블릿은 클라이언트의 요청을 처리하고 결과를 반환하는 자바 웹 프로그래밍 기술이다.

웹 서버나 애플리케이션 서버에서 실행되며, 클라이언트로부터의 요청을 받고, 그에 대한 처리를 수행한 뒤에 응답을 반환한다.

서블릿은 자바언어로 작성되었으며 JVM 위에서 실행한다. 이로 인해 자바의 이식성, 보안성, 성능 등의 이점을 활용할 수 있다.&#x20;

그러면 왜 JVM 위에서 실행하는것이 이식성, 보안성, 성능 이점을 볼 수 있을까 ??

* 이식성: 자바는 한번 작성하면, 어디서나 실행 이라는 이식성의 원칙을 따른다. JVM 위에서 실행되기 때문에 서블릿은 다양한 하드웨어와 운영 체제 환경에서 호환되어 실행될 수 있다.
* 보안성: 자바는 강력한 보안 기능을 제공한다. JVM은 코드를 실행하기 전에 여러 보안 검사를 수행한다. 또한 자바는 메모리 관리, 예외 처리, 타입 검사 등을 통해 메모리 손상, 버퍼 오퍼플로우와 같은 일반적인 보안 취약점을 방지한다.
* 성능: JIT 컴파일러, 가비지 컬렉션 등으로 인해 JVM은 높은 성능과 최적화를 제공한다.

서블릿은 서블릿 컨테이너에서 관리한다.&#x20;

앞서 컨테이너 용어에 대해서 얘기했었는데 , 여기서 말한 서블릿 컨테이너는 Tomcat, Jetty, Undertow 를 말한다. 스프링 부트는 이러한 서블릿 컨테이너를 자동으로 구성한다.

서블릿 컨테이너는 서블릿 인스턴스를 생성하고 관리하는 역할을 수행한다.

대표적으로 톰켓인데 톰캣은 WAS 의 역할과 서블릿 컨테이너의 역할을 수행한다.&#x20;

서블릿 컨테이너의 특징으로는

* 서블릿 객체를 생성, 초기화, 호출, 종료하는 생명주기를 관리한다.
* 서블릿 객체는 싱글톤 패턴으로 관리한다.
* 멀티 스레딩을 지원한다.

<figure><img src="../.gitbook/assets/스크린샷 2023-11-25 오전 9.04.55.png" alt=""><figcaption></figcaption></figure>

### 📌 DispatcherServlet

스프링에서는 DispatcherServlet 이 서블릿의 역할을 수행한다.

일반적으로 스프링은 톰캣을 임베드해 사용한다.

그렇기 때문에 서블릿 컨테이너와 DispatcherServlet 은 자동 설정된 web.xml 의 설정값을 공유한다.



DispatcherServlet 의 동작을 간략히 살펴보겠습니다.

DispatcherServlet 으로 요청이 들어오면 DispatcherServlet은 핸들러 매핑을 통해 요청 URI 에 매핑된 핸들러를 탐색한다. 여기서 핸들러는 컨트롤러를 의미한다.

그리고 핸들러 어댑터로 컨트롤러를 호출한다.

핸들러 어댑터에 컨트롤러의 응답이 돌아오면 ModelAndView로 응답을 가공해 반환한다.

뷰 형식으로 리턴하는 컨트롤러를 사용할 때는 뷰 리졸버를 통해 뷰를 받아 리턴한다.



DispatcherServlet 은 모든 요청을 받아들이고, 해당 요청을 처리할 적절한 핸들러에게 전달한다.

이 과정에서 요청의 경로와 HTTP 메서드를 기반으로 적절한 컨트롤러를 결정한다.

적절한 컨트롤러를 결정하기 위해서 DispatcherServlet 은 핸들러 매핑 정보를 사용하게 된다.

이는 URL 패턴과 컨트롤러 메서드 간의 매핑을 정의한다.

선택된 컨트롤러의 메서드를 호출하기 위해 DispatcherServlet 은 핸들러 어댑터를 사용한다.

이 어댑터는 컨트롤러 메서드의 호출 방식과 매개변수 바인딩 등을 처리한다.



컨트롤러가 처리를 완료하고 반환하는 뷰 이름을 기반으로, DispatcherServlet 은 적절한 뷰 객체를 찾아 클라이언트에게 응답을 반환한다.



만약에 우리가 Spring 에서 프론트코드까지 다루게 된다면 뷰 리졸버를 호출하게 될것이다.

하지만 우리는 REST 형식의 @ResponseBody 를 자주 사용하게 된다.&#x20;

그러므로 MessageConverter 를 거쳐 JSON 형식으로 변환해서 응답한다.

<figure><img src="../.gitbook/assets/스크린샷 2023-11-25 오후 9.51.36.png" alt="" width="563"><figcaption></figcaption></figure>

여기서 MessageConverter 는 요청과 응답에 대해 Body 값을 변환하는 역할을 수행한다.

스프링 부트의 자동 설정 내역을 보면 HttpMessageConverter 인터페이스를 사용하고 있다.

[https://jaimemin.tistory.com/1823](https://jaimemin.tistory.com/1823)
